In spite of botnet’s relatively long presence in the Internet, few botnet detection researches have been proposed. In this section, several approaches among the researches.

Tung-Ming Koo et al. have proposed P2P firewall HTTP-Botnet defense mechanis, which uses Repeatability Standard Deviation method to detect the connection of Botnets within HTTP protocol. Furthermore,  they used JXTA P2P network to share the results they have detected, and users can compare the packets of traffic with lists of the filtering mechanism. Using P2P technique to exchange the information detected by authors, users who have been infected can find the connection of HTTP Botnet servers. And uninfected users can use this information as a comparison sample, when there are new packets. Users can use it for determining whether the connections are malicious or not, to achieve the purpose of co-defensive. Lists of filtering mechanism allow the duplicated packets entered in computers, compared only one time with the large number of blacklist. By using the P2P technique, authors can not only decrease the cost of implementation, but also let the network more resilient [1].\\

Hyunsang Choi et al. have proposed a botnet detection mechanism by monitoring DNS traffic to detect botnets, which form a group activity in DNS queries simultaneously sent by distributed bots. A few works have been proposed based on particular DNS information generated by a botnet, but they are easily evaded by changing bot programs. Anomaly-based botnet detection mechanism is more robust than the previous approaches so that the variants of bots can be detectable by looking at their group activities in DNS traffic. From the experiments on a campus network, it is shown that the proposed mechanism can detect botnets effectively while bots are connecting to their server or migrating to another server. A botnet DNS query detection algorithm by using the different features of botnet DNS and legitimate DNS. The algorithm separated different parts which are (1) Insert-DNS-Query, (2) Delete DNS-Query, (3) Detect-BotDNS-Query. Insert-DNS-Query stage of algorithm. There is a database for storing DNS query data which include source IP address of the query, domain name of the query and timestamp of the query received [2].\\

Hyunsang Choi et al. have proposed a group activity as an inherent property of the botnet. Based on the group activity model and metric, they  develop a botnet detection mechanism, called BotGAD (Botnet Group Activity Detector). BotGAD enables to detect unknown botnets from large scale networks in real-time. Botnets frequently use DNS to rally infected hosts, launch attacks and update their codes. Implemented Bot-GAD using DNS traffic and showed the effectiveness by experimentson real-life network traces. BotGAD captured 20 unknown and 10 known botnets from two day campus network traces [3].\\

Govil J et al. proposed Criminology of BotNets and their detection and defense methods. A Botnet is a linked group of infected computers (termed as bots or zombie), which communicate with each other and get their commands from a controller, called Botmaster. A Botmaster has a mechanism to control their Botnets by sending commands to the bots and receiving response from them. Different command and control mechanisms (e.g. IRC,HTTP, and P2P) are used by Botmasters to achieve this goal. The main aim of Botnets is to carry out different types of malicious activities or to gain illegal profits. Some of these activities such as Distributed Denial of Service (DDoS), Spamming, Thieving Personal Information, Illegal Hosting, Click Fraud described as follows:

\begin{itemize}
\item DDOS

\hspace{0.5cm}Denial of Services (DoS) attack is an attempt on a computer system or network to make unavailable the computational resources to its intended user. A Distributed DoS (DDoS) attack is a DoS attack which involves use of multiple compromised systems to cause a loss of service to its intended users by depleting the bandwidth and other computational resources of the target system or network. Bandwidth depletion and resource depletion are two main variants of DDoS attacks. Flooding and reflection attacks are two primary types of bandwidth depletion attacks. Bandwidth depletion involves flooding a target machine with unwanted traffic as an attempt to overwhelm the processing power of the target machine. Flooding attack involves sending multiple packets to some target website simultaneously to congest traffic. The reflection attack involves sending many packets to many computers with a spoofed source address. Resource depletion also called protocol exploitation involves a target that specifically attempts to deplete resources on the targeted computer or cause it to become unstable and crash. To launch a DDoS attack using botnet has several advantages that include magnifying impact of the attack without the requirement of any source IP address spoofing.

\item Spamming

Spamming refers to emails, which have the same content but are sent in high volume. Botnets can be considered as a perfect platform to collect different email addresses from infected computers, and generate and send spam or phishing emails. Loosely defining spam is any message or posting, regardless of its content, that is sent to multiple recipients who have not specifically requested the message (Opt-In). Spam can also be multiple postings of the same message to newsgroups or list servers. A person engaged in spamming is called spammer. Spam in blogs called blog spam or comment spam is a form of search engine spamming done manually or automatically by posting random comments, promoting commercial services, to blogs, wikis,guestbooks, or other publicly-accessible online discussion boards.\\

\hspace{0.5cm}Any web application that accepts and displays hyperlinks submitted by visitors may be a target of Link Spam. This is the placing or solicitation of links randomly on other sites, placing a desired keyword into the hyperlinked text of the backlink. Blogs, guest books, forums and any site that accepts visitors' comments are particular targets and are often victims of drive-by spamming, where automated software creates nonsense posts with links that are usually irrelevant and unwanted. Link spam dishonestly and deliberately manipulates link-based ranking algorithms of search engines like Google's PageRank to increase the rank of a web site or page so that it is placed as close to the top of search results as possible. Spam generally refers to email, rather than other forms of electronic communication. The term spim, for example, is used for unsolicited advertising via Instant Messaging. Spit refers to unsolicited advertising via Voice Over Internet Protocol(VOIP). Unsolicited advertising on wireless devices such as cell phones is called wireless spam.\\

\hspace{0.5cm}Spammers use various techniques and tools that include spoofing, spam botnets open proxies, open mail relays, untraceable Internet connections, and bulk email tools for sending unsolicited bulk email. Spammers operate as a creative group who work through secret networks to meet and share email addresses. The two most effective approaches to gather or harvest emails are to monitor Internet use and to ask for email addresses. Some of the most popular methods of email harvesting are guessing, purchased lists, legitimate email lists, web pages, white $\diagdown$ yellow page sites, web \& paper forms, usenet posts, web browser, hacking, user profiles, irc and chat rooms.\\

\item Phishing and Identity Theft

\hspace{0.5cm}Phishing is used to describe spoof emails and other technical ploys to trick receipts into giving up their personal or their company’s confidential information such as social security number, financial account credentials and other identity and security information. Some phishing emails look extremely professional and realistic, while others are crude and badly constructed but have a common goal to steal information through deception. This form of identity theft employs both social engineering and technical subterfuge to steal account access information, identity or other proprietary information that can be sold on to third party via specialized chat rooms established specifically for this purpose. Selling the information onwards reduces the risk of being apprehended by minimizing the direct link between the hacker and those using the information to gain unauthorized access to accounts and profiting from them. Social engineering schemes use spoofed emails to lead customers to counterfeit websites designed to trick recipients into divulging financial data. Technical subterfuge schemes plant crime ware onto computers to steal credentials directly using keylogging systems. Pharming crimeware misdirects users to fraudulent sites or proxy servers, typically through Domain Name System (DNS) hijacking or poisoning.\\

\hspace{0.5cm}The term “phishing” evolved from the word “fishing” and follows a very similar approach. Fraudsters and scammers, the “fishermen”, send out large quantities of deceptive emails, the “bait”, to mostly random address across the Internet. Phishing is a serious and increasingly prolific form of spam, and is one of the main tactics employed in business and consumer identity theft. Phishing actually comprises of two online identity thefts which are the identity of the target company and its unsuspecting customers. Target Company is commonly a bank, online payment service or other reputable business organization. A typical phishing attack is made up of two components: an authentic looking email and a fraudulent Web page. This form of spam of email frequently has a professional look that includes company logos, colors, graphics, font styles, and other elements to successfully spoof the sender. The content of the phishing email is usually designed to confuse, upset, or excite the recipient. Typical email topics include account problems, account verifications, security updates/upgrades, and new product or service offerings. Recipients of email are prompted to react immediately and click on a link provided in the email body, which actually directs them to the phishing Web page. The intent is to lure recipients into revealing sensitive information such as usernames, passwords, account IDs, ATM PINs, or credit card details. Like the phishing email, the phishing Web page almost always possesses the look and feel of the legitimate site that it copies, often containing the same company logos, graphics, writing style, fonts, layout, and other site elements. This spoofed Web page may also include a graphical user interface (GUI) intended to lure the user into entering their bank account information, credit card number, social security number, passwords, or other sensitive information. Either the phisher, or an anonymous remote user that is sent the information, can then use the stolen information.\\

\hspace{0.5cm}Phishing approaches used for identity thefts are constantly growing and new variants are tried and used to attack business organizations, financial institutions, and customers. Some of the most prevalent types of phishing and identity theft attacks include deceptive phishing, malware based phishing, key loggers, screen loggers, session hijacking, web Trojans, hosts file poisoning, system reconfiguration attacks, data theft, DNSbased phishing also called pharming, content injection phishing, man-in-the-middle phishing, search engine phishing, spear phishing, vishing or voice phishing. The phishing “ecosystem” consists of a collection of individuals who play various roles within the phishing space, ranging from the financially-motivated botnet creators to those who actively pursue and prosecute the cybercriminals. In this ecosystem, a large industry of buying and selling - a “microeconomy” - exists within the phishing underground, involving botnet creators, perpetrators, and enablers. However, these three player groups are complex and intertwined: a single individual or multiple perpetrators can play separate or simultaneous roles. Botnets, with an army of thousands of bots awaiting their instructions can use packet sniffers to watch for sensitive information like usernames and passwords on the machine it has intruded and accordingly send this to the botmaster.


\item Illegal hosting

\hspace{0.5cm}Illegal material such as child pornographic pictures, videos and other such material, pirated software or code to crack the licensed software, pirated e-books, pirated games, etc. can be stored as a dynamic repository on a bot compromised computer by the botmaster. Often this illegal material contains malicious code in the form of malware like viruses, Trojan horses, worms and others like spyware and adware. All bots contain functionality that allows FTP, TFTP, and HTTP downloads and execution of binaries. This is the primary method used by botnets to update their malicious code; however it is not limited to this alone but can be used to download any file botmaster commands it to. This ability of bots to download and install any binary is often used to install additional malware like Viruses, Trojan Horses, worms and other malicious code like spyware and adware.\\
 \hspace{0.5cm}A malware is an undesired code surreptitiously introduced into a computer system to harm it. Spyware is software that is used to collect personal information about users without their informed consent. Adware is software with advertizing functions that are integrated into or bundled with a software package to recover the costs of programming or reduce or even provide the software free of cost to users. However adware may often take the form of spyware in which the users’ activity is tracked by the software and sold without the consent or knowledge of the user. A computer or server with a large storage and a high-bandwidth connection to the Internet can became a target for a Botmaster to gain control and use for file sharing, illegally.

\item Click Fraud and Adware

One of the main differences between Botnets and other Internet threats is that a Botnet can be used to make money by click frauding. Botmasters can amass a lot of money by using their bots to click on open websites that pay a small sum of money for each visit to the website or for each click on the advertisement. Pop-up advertisements can also be downloaded, installed, or displayed by bots to force a user to visit particular websites. Some of the advertisements appearing on the websites are charged by the website operators on the basis of pay per click revenue model wherein an advertiser is charged on the basis of the number of clicks made by visitors on the advertisement appearing in a website. Any mechanism that is used to increment this click counter in an automated or artificial manner is click fraud. For illicit financial advantages botmaster can increment the click counter in an artificial manner by commanding bots under its control to send web requests that represent clicks on Internet advertisements.\\
\hspace{0.5cm}Botnet based click fraud is harder to detect because botnet comprises of large number of geographically dispersed IP addresses and click through pattern matching wherein geographical locations of IP addresses from each click are monitored fails. Click fraud activity generates large volumes of revenue for attackers and their customers but at the same time poses a great threat to both the advertisers and the content providers and thus is considered as an emerging threat to e-commerce. Several examples of use of botnet in facilitating click fraud have been reported wherein the content provider had to pay huge amount to settle the lawsuit alleging the content providers of overcharging the advertiser. One such recent example has been reported in July 2006 where Google agreed to pay US\$ 90 million to settle such a lawsuit. In addition, the Botnets can be used to spread different types of computer threats in the form of viruses, Trojans, Backdoors, worms, etc. This means that Botnets are not only a threat, but also a platform for the distribution of other threats.

\item Other Security Threats

 \hspace{0.5cm}Although botmasters need not to be highly technical yet some are skilled, organized and are getting smarter day by day. Further, they have thousands of bot compromised computers at their disposal and thus can launch variety attacks other than those detailed above. Online games and polls can easily fall victim to botnets where bots can manipulate the results. Bots can be levered to steal the online software license by transferring the same to some other computer. Key loggers can be deployed with bots to retrieve sensitive and secret data. Bots can use packet sniffing to watch for clear text data passing by compromised machines and retrieve sensitive data such as usernames and passwords. Botnets can setup a fake website with advertisements thus leading to click fraud. Bots are used to download and execute harmful executive files via FTP or HTTP and thus spread new malware and viruses. The growing access to Internet through mobile phones can prompt hackers to attack cellular network system and create botnets on this system which may cause inconvenience to millions of cell phone users [4,6].
\end{itemize}

M. Tariq Banday et al. have proposed Study of Botnets and Their Threats to Internet Security  in which detailed study of botnets their creation, propagation, command and control techniques, communication protocols and relay mechanism is presented. The aim of this paper is to gain an insight of security threats that users of Internet are facing from hackers by the use of malicious botnets [6].\\

Ping Wang et al. have proposed Systematic Study on Peer-to-Peer Botnets in which P2P botnets along multiple dimensions: bot candidate selection, network construction, C\&C mechanisms and communication protocols, and mitigation approaches. authors study two defense approaches: index poisoning and sybil attack. According to the common idea shared by them, author are able to give analytical results to evaluate their performance. They propose possible counter techniques which might be developed by attackers against index poisoning and sybil attack defenses. In addition, author obtain one interesting finding: compared to traditional centralized botnets, by using index poisoning technique, it is easier to shut down or at least effectively mitigate P2P botnets that adopt existing P2P protocols and rely on file index to disseminate commands. author studies P2P botnets along multiple dimensions: infection vectors, bot candidate selection, bootstrap procedure, network structure, and C\&C mechanisms and communication protocols. Present a number of countermeasures to defend against P2P botnets. Index poisoning and sybil attack shows that both of these defense approaches share a common scheme, which leads us to analytical work on the evaluation of their performance. Author obtains one counter-intuitive finding: if the index poisoning defense is valid (when the botnet adopts existing P2P protocols and relies on file index to disseminate commands), P2P botnets are equally easy (or hard) to defend compared to traditional centralized botnets. From attackers’ perspective, author propose a novel and realistic technique that might be deployed by them to counter
the index poisoning defense. This method guarantees that command related indices can be generated by and only by botmasters, not by ordinary bots [7].\\

Guofei Gu et al. have proposed BotSniffer: Detecting Botnet Command and Control Channels in Network Traffic in which an approach that uses network-based anomaly detection to identify botnet C\&C channels in a local area network without any prior knowledge of signatures or C\&C server addresses. This detection approach can identify both the C\&C servers and infected hosts in the network. Our approach is based on the observation that, because of the preprogrammed activities related to C\&C, bots within the same botnet will likely demonstrate spatial-temporal correlation and similarity. For example, they engage in coordinated communication, propagation, and attack and fraudulent activities. The prototype system, BotSniffer, can capture this spatial-temporal correlation in network traffic and utilize statistical algorithms to detect botnets with theoretical bounds on the false positive and false negative rates. The architecture of BotSniffer there are two main components, i.e., the monitor engine and the correlation engine. The monitor engine is deployed at the perimeter of a monitored network. It examines network traffic, generates connection record of suspicious C\&C protocols, and detects activity response behavior (e.g., scanning, spamming) and message response behavior (e.g., IRC PRIVMSG) in the monitored network. The events observed by the monitor engine are analyzed by the correlation engine. It performs group analysis of spatial-temporal correlation and similarity of activity or message response behaviors of the clients that connect to the same IRC or HTTP server. The monitor engines can be distributed on several networks, and collect information to a central repository to perform correlation analysis [8].

\section{Existing Botnet Detection Methods}

\subsection{Honeypot and Honeynet}
Honeypots are tools that are used as traps for bots as they can detect bots or collect information on their activities. The information can be used to understand more about bots’ behaviour or the intentions of the Botmasters. Nepenthes is a good example of a Honeypot that is used to collect the bots binary codes and other information about them. Honeypots are used  to collect information about DDOS attacks. This information includes DDOS signs and characteristics, cases, and the attacker’s intention and behaviour. This information is useful for the development of methods to prevent DDOS attacks. Another technique which combined several Honeypots as a multifaceted approach to collect a large amount of information about IRC bots. By analysing the data, as well as tracking the activities of the bots, they learned more about the bots characteristics and behaviour. Like any other tools and techniques, Honeypots have their weaknesses.\\
There are two types of Honeypots - low-interaction honeypots, and high-interaction honeypots. The main difference between them is the level of access rights to system resources, services, and functions. Low-interaction honeypots like Nepenthes, are installed on computers to emulate limited services of their operating system, thus, they provide Botmasters limited interaction with the computers. Therefore, these computers may not be completely compromised, and the information collected on them may not be sufficient for analysis to detect Botnets. On the other hand, the high-interaction honeypots do not emulate any services of operating system but provide the real system and services. The Botmaster can use this real services to gain full control of the computer in which the high-interaction honeypot is installed Today, it is not surprising that Botmasters use many techniques to avoid the honeypots [10].

\subsection{Detection by Signature}
Signature refers to the known patterns or characteristics of threats from intruders into computer systems. By analysing and comparing these patterns or characteristics, it is possible to distinguish the threat activities from the normal activities.
The signature-based detection method is not very effective because this method cannot identify new behaviour patterns or certain characteristics. This method is based on a simple comparison of the collected information with the predefined characteristics of well-known bots. Thus, this method is good for detecting well-known bots, but quite useless for detecting new and zero-day bots. Using this method, known as Rishi, a reasonable amount of information on IRC traffic can be collected. Subsequently, all the IRC nicknames are extracted from the collected data and checked for known bots’ nicknames by using some regular expressions [4].

\subsection{Detection by DNS Monitoring}
Monitoring and analysing the DNS traffic generated by bots had been used as a technique to detect Botnets. Bots generate DNS traffic in some situations, for example, when identifying the Command and Control server or arranging attacks such as DDOS attack. The researchers used three main differences between the bot-generated DNS flows and the normal DNS flows, as ways to detect Botnets. The first difference they noticed is the amount of the source IP addresses that send the DNS queries to specific domain names. The Botnet DNS queries are generated by a fixed number of IP addresses that belong to the bots in the same Botnet. On the other hand, a number of IP addresses of legitimate DNS queries generated by anonymous users to a particular domain name, are random. The second difference is the difference in the format and frequency of DNS queries generated by bots and by normal users. Bots have similar group activities, thus, DNS queries of the same format are generated by bots from the same Botnets, intermittently, and only in special situations, but the DNS queries of normal users are generated continuously, and in a random format. The third difference is that normal users hardly use a distributed DNS (DDNS), whereas, it is used by bots [2].

\subsection{Detection using Attack Behaviour Analysis}
In this method, the characteristics and behaviour of attacks have been studied by researchers more than other issues such as the bots, Command and Control servers, or Botmaster behaviour, or the communication methods used. System called RB-Seeker, which has three different sub-systems to detect bots that carry out URL redirection attacks. The first two sub-systems of the method attempt to identify all domains, which are related to redirection activities, based on the characteristics and behaviour of the URL redirection attack. At this stage, the system does not make any decision about the domain status, which can either be normal or malicious. In the next stage, the third sub-system examines the DNS queries to distinguish the malicious domains from the normal domains. This method, however, uses DNS-based techniques, but the main aim is to focus more on URL redirection activities, and DNS probing is used only as a sub-system. Therefore, this method does not belong to the DNS-based category.

\subsection{Detection Based on Network Behaviour Analysis}
Network Behaviour Analysis or NBA is a method that can be used to collect a wide range of information and statistics about network traffic. The information is analysed to detect for any signs of threats or malicious activities. The NBA method consists of several components that include the sensors and management servers (Analyser). The NBA system collects information such as IP addresses, operating system, available services, and logging data such as Timestamp, event type, network protocols, host ports, and additional packet header field for each client [8].

